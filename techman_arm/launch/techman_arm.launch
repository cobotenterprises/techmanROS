<?xml version="1.0"?>
<launch>
   <arg name="simulated" default="false" />
   <arg name="rviz" default="false" />

   <include file="$(find tm5700_model)/launch/load.launch" />

   <group unless="$(arg simulated)">
      <arg name="planner" default="moveit" />
      <arg name="robot_ip" default="" />

      <!-- Start joint state visualizer -->
      <node pkg="robot_state_publisher" name="robot_state_publisher" type="robot_state_publisher" output="screen" required="true" /> 
      <node pkg="joint_state_publisher" name="joint_state_publisher" type="joint_state_publisher" output="screen" required="true">
         <rosparam>source_list: [/techman_arm/joint_states]</rosparam>
      </node> 

      <!-- Start techman arm node -->
      <node pkg="techman_arm" name="techman_arm" type="techman_arm_real.py" args="$(arg robot_ip) $(arg planner)" output="screen" required="true" /> 
   </group>

   <group if="$(arg simulated)">
      <arg name="x" default="0"/>
      <arg name="y" default="0"/>
      <arg name="z" default="0"/>
      <arg name="gzclient" default="true" />

      <include file="$(find tm5700_gazebo)/launch/gazebo.launch">
         <arg name="client" value="$(arg gzclient)" />
         <arg name="x" value="$(arg x)"/>
         <arg name="y" value="$(arg y)"/>
         <arg name="z" value="$(arg z)"/>
      </include>

      <!-- Start techman arm simulated node -->
      <node pkg="techman_arm" name="techman_arm" type="techman_arm_sim_node.py" output="screen" required="true" />
   </group>
  
   <!-- Start RViz -->
   <group if="$(arg rviz)">
      <node name="rviz" pkg="rviz" type="rviz" args="-d $(find techman_arm)/launch/config.rviz" required="true" />
   </group>
</launch>